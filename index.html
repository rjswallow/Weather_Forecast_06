<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width , initial-scale=1.0">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <title>Weather Dashboard</title>
</head>

<body>
  
    <header class="bg-dark text-light" style="text-align: center;">
        <h1>Weather Dashboard</h1>
    </header>

    <div class="container-fluid bg-dark">

        <div class="row">

            <div class="col-md-4 text-white">

                <h4>Search for a city: </h4>

                <div class="input mb-3">
                    <input type="text" class="form-control" placeholder="City Name" id="search-term">
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="button" id="searchBtn">Search</button>
                    </div>
                </div>
                <ul id="city-list"></ul>
            </div>





            <div class="col-md-8">

                <div class="row">
                    <div class="col-md-10">
                        <div class="card my-3">
                            <h2 id="citySearch">

                            </h2>
                           
                            <img id="crntIcon"><br>
                            <div id="crntDate"></div><br>

                            <label for="crntTemp"></label>
                            <div style="display: inline" id="crntTemp"></div><br>

                            <label for="crntHumidity"></label>
                            <div style="display: inline" id="crntHumidity"></div><br>

                            <label for="crntWind"></label>
                            <div style="display: inline" id="crntWind"></div><br>

                            <label for="crntIndex"></label>
                            <div style="display: inline" id="crntIndex"></div><br>


                        </div>
                    </div>
                </div>

                <div class="row">
                    <h2>
                        5 Day Forecast
                    </h2><br>
                    <div class="row" id="futureCast"></div>
                </div>

            </div>



        </div>

    </div>



    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" crossorigin="anonymous"></script>
        <script>
    
            // City current weather
            let cityName = "Sapporo"
            const url = "https://api.openweathermap.org/"
            const apiKey = "098c93e8d17b5848e68a154c5abf26ec"
    
            let endPoint = url + "data/2.5/weather?q=" + cityName + "&units=imperial" + "&appid=" + apiKey
            let endPoint2 = url + "data/2.5/forecast?q=" + cityName + "&units=imperial" + "&appid=" + apiKey
            let endpoint3 = url + "data/2.5/uvi?lat="
             
    
            console.log(endPoint)
            console.log(endPoint2)
    
            $.ajax({
                    url: endPoint,
                    method: "GET",
                })
                    .then(function (response) {

                        // display current city and date
                        let span = $("<span>").text(response.name)
                        let currentDate = moment(response.dt, "X").format(" (MM/DD/YYYY)")
                        $("#citySearch").append(span, currentDate)

                        //  display current temp
                        let temp = $("<span>").text("Current Temp: " + response.main.temp + "ÂºF")
                        $("#crntTemp").append(temp)

                        // display current humidity  
                        let humidity = $("<span>").text("Current Humidity: " + response.main.humidity + "%")
                        $("#crntHumidity").append(humidity)

                        // display current wind speed
                        let wind = $("<span>").text("Current Wind Speed: " + response.wind.speed + " mph")
                        $("#crntWind").append(wind)

                        console.log(response);
                        console.log("temp " + response.main.temp)
                        console.log("humidity " + response.main.humidity)
                        console.log("wind " + response.wind.speed)
                        console.log(response.coord.lon)
                        console.log(response.coord.lat)
                        console.log(endpoint3 + response.coord.lat.toString() + "&lon=" + response.coord.lon + "&appid=" + apiKey)
                        
                        // call for UV Index
                        $.ajax({
                            url: endpoint3 + response.coord.lat.toString() + "&lon=" + response.coord.lon.toString() + "&appid=" + apiKey,
                            method: "GET"
                        })
                            .then(function (uvResponse) {
                                let uvIndex =  $("<span>").text("Current UV Index: " + uvResponse.value)
                                    $("#crntIndex").append(uvIndex)

                                console.log(uvResponse)
                                console.log(uvResponse.value)
                                
                            })

                    })
    
    
            $.ajax({
                url: endPoint2,
                method: "GET",
            }).then(function (response) {
                console.log(response);
            })
    
    
    
        </script>
    
</body>

</html>